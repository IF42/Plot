#include "plot.h"

#include <stdio.h>
#include <stdlib.h>
#include <string.h>
#include <math.h>
#include <assert.h>



static Plot * __plot_new(size_t width, size_t height, RGBA * color) {
    size_t size = width * height;
    Plot * self = malloc(sizeof(Plot) + (size * sizeof(uint32_t)));

    *self = (Plot) {size, width, height};
    
    for(size_t i = 0; i < size; i++)
        self->pixel[i] = color->dword;

    return self;
}


static void __set_pixel(Plot * self, float x, float y, RGBA * color) {
  if(x < self->width && y < self->height)
		self->pixel[(size_t) (self->width * y + x)] = color->dword;
}


static void __draw_horizontal_line(Plot * self, float x, float y, float length, size_t thickness, RGBA * color) {
	for(size_t i = 0; i < (size_t) length; i++) { 
		for(size_t w = 0; w < (size_t) thickness; w++) 
			__set_pixel(self, x + i, y + w, color);
	}
}


static void __draw_vertical_line(Plot * self, float x, float y, float length, size_t thickness, RGBA * color) {
	for(size_t i = 0; i < (size_t) length; i++) { 
		for(size_t w = 0; w < (size_t) thickness; w++) 
			__set_pixel(self, x + w, y + i, color);
	}
}


static void __draw_rectangle(Plot * self, float x, float y, float width, float height, size_t thickness, RGBA * color) {
	__draw_horizontal_line(self, x, y, width+thickness, thickness, color);
	__draw_horizontal_line(self, x, y + height, width+thickness, thickness, color);
	__draw_vertical_line(self, x, y, height+thickness, thickness, color);
	__draw_vertical_line(self, x + width, y, height+thickness, thickness, color);
}


static void __draw_filled_rectangle(Plot * self, float x, float y, float width, float height, RGBA * color) {
	for(size_t i = 0; i < (size_t) width; i++) {
    	for(size_t j = 0; j < (size_t) height; j++)
			__set_pixel(self, x + i, y + j, color);
  	}
}


#define sgn(a) (((a) < 0) ? -1 : 1)
#define abs(a) (((a) < 0) ? -(a) : a)


void __draw_filled_circle(Plot * self, float x, float y, float radius, RGBA * color) {
    double pixels, da, dx, dy;

    /* Place the circle in the center of the pixel. */
    x = floor(x) + 0.5;
    y = floor(y) + 0.5;

    pixels = 2.0*M_PI*radius;

    /* Below a radius of 10 pixels, over-compensate to get a smoother circle. */
    if(radius < 10.0) {
	    pixels = pixels*10.0;
    }

    da = 2.0*M_PI/pixels;

    /* Draw lines for a half-circle to fill an entire circle. */
    for(double a = 0.0; a < M_PI; a = a + da) {
	    dx = cos(a)*radius;
	    dy = sin(a)*radius;

	    /* Floor to get the pixel coordinate. */
	    __draw_vertical_line(self, floor(x - dx), floor(y - dy), floor(2.0 * dy) + 1.0, 1, color);
    }
}


static void __draw_circle_1px(Plot * self, float x, float y, double radius, RGBA * color) {
    double pixels, a, da, dx, dy;

    /* Place the circle in the center of the pixel. */
    x = floor(x) + 0.5;
    y = floor(y) + 0.5;

    pixels = 2.0 * M_PI * radius;

    /* Below a radius of 10 pixels, over-compensate to get a smoother circle. */
    if(radius < 10.0) {
        pixels = pixels * 10.0;
    }

    da = 2.0 * M_PI / pixels;

    for(a = 0.0; a < 2.0 * M_PI; a = a + da) {
        dx = cos(a)*radius;
        dy = sin(a)*radius;

        /* Floor to get the pixel coordinate. */
        __set_pixel(self, floor(x + dx), floor(y + dy), color);
    }
}


static void __draw_circle(Plot * self, float x, float y, double radius, size_t thickness, RGBA * color) {
	for(size_t i = 0; i < thickness; i++) {
		__draw_circle_1px(self, x, y, radius+i, color);
	}
}


static void __draw_filled_circle_with_border(Plot * self, float x, float y, float radius, float border_thickness, RGBA * border_color, RGBA * fill_color) {
	if(radius >= 2 * border_thickness) {
		__draw_filled_circle(self, x, y, radius, border_color);
		__draw_filled_circle(self, x, y, radius - (2*border_thickness), fill_color);
	} else {
		__draw_filled_circle(self, x, y, radius, border_color);
	}
}


static void __draw_curve(Plot * self, double x0, double y0, double x1, double y1, int thickness, RGBA * color) {
	float dx = x1 - x0;
    float dy = y1 - y0;
    float length = sqrt(dx * dx + dy * dy);

    dx /= length;
    dy /= length;

    for (float i = 0.0; i < length; i += 0.001) {
        int x = x0 + i * dx;
        int y = y0 + i * dy;

		if(thickness > 1)
			__draw_filled_rectangle(self, x, y, thickness, thickness, color);
		else
			__set_pixel(self, x, y, color);
    }
}


#define CHAR_WIDTH 8
#define CHAR_HEIGHT 13
#define SPACE_WIDTH 2


typedef char ASCII[CHAR_HEIGHT][CHAR_WIDTH];


static const ASCII ascii_pixel_array[] = 
{{{0, 0, 0, 0, 0, 0, 0, 0}, {0, 0, 0, 0, 0, 0, 0, 0}, {0, 0, 0, 0, 0, 0, 0, 0}, {0, 0, 0, 0, 0, 0, 0, 0}
  , {0, 0, 0, 0, 0, 0, 0, 0}, {0, 0, 0, 0, 0, 0, 0, 0}, {0, 0, 0, 0, 0, 0, 0, 0}, {0, 0, 0, 0, 0, 0, 0, 0} 
  , {0, 0, 0, 0, 0, 0, 0, 0}, {0, 0, 0, 0, 0, 0, 0, 0}, {0, 0, 0, 0, 0, 0, 0, 0}, {0, 0, 0, 0, 0, 0, 0, 0}
  , {0, 0, 0, 0, 0, 0, 0, 0}}
  , {{0, 0, 0, 0, 0, 0, 0, 0}, {0, 0, 0, 0, 0, 0, 0, 0}, {0, 0, 0, 1, 1, 0, 0, 0}, {0, 0, 0, 1, 1, 0, 0, 0}
  , {0, 0, 0, 0, 0, 0, 0, 0}, {0, 0, 0, 0, 0, 0, 0, 0}, {0, 0, 0, 1, 1, 0, 0, 0}, {0, 0, 0, 1, 1, 0, 0, 0}
  , {0, 0, 0, 1, 1, 0, 0, 0}, {0, 0, 0, 1, 1, 0, 0, 0}, {0, 0, 0, 1, 1, 0, 0, 0}, {0, 0, 0, 1, 1, 0, 0, 0}
  , {0, 0, 0, 1, 1, 0, 0, 0}}
  , {{0, 0, 0, 0, 0, 0, 0, 0}, {0, 0, 0, 0, 0, 0, 0, 0}, {0, 0, 0, 0, 0, 0, 0, 0}, {0, 0, 0, 0, 0, 0, 0, 0}
  , {0, 0, 0, 0, 0, 0, 0, 0}, {0, 0, 0, 0, 0, 0, 0, 0}, {0, 0, 0, 0, 0, 0, 0, 0}, {0, 0, 0, 0, 0, 0, 0, 0}
  , {0, 0, 0, 0, 0, 0, 0, 0}, {0, 1, 1, 0, 1, 1, 0, 0}, {0, 1, 1, 0, 1, 1, 0, 0}, {0, 1, 1, 0, 1, 1, 0, 0}
  , {0, 1, 1, 0, 1, 1, 0, 0}}
  , {{0, 0, 0, 0, 0, 0, 0, 0}, {0, 0, 0, 0, 0, 0, 0, 0}, {0, 0, 0, 0, 0, 0, 0, 0}, {0, 1, 1, 0, 0, 1, 1, 0}
  , {0, 1, 1, 0, 0, 1, 1, 0}, {1, 1, 1, 1, 1, 1, 1, 1}, {0, 1, 1, 0, 0, 1, 1, 0}, {0, 1, 1, 0, 0, 1, 1, 0}
  , {1, 1, 1, 1, 1, 1, 1, 1}, {0, 1, 1, 0, 0, 1, 1, 0}, {0, 1, 1, 0, 0, 1, 1, 0}, {0, 0, 0, 0, 0, 0, 0, 0}
  , {0, 0, 0, 0, 0, 0, 0, 0}}
  , {{0, 0, 0, 0, 0, 0, 0, 0}, {0, 0, 0, 0, 0, 0, 0, 0}, {0, 0, 0, 1, 1, 0, 0, 0}, {0, 1, 1, 1, 1, 1, 1, 0}
  , {1, 1, 1, 1, 1, 1, 1, 1}, {1, 1, 0, 1, 1, 0, 0, 0}, {1, 1, 1, 1, 1, 0, 0, 0}, {0, 1, 1, 1, 1, 1, 1, 0}
  , {0, 0, 0, 1, 1, 1, 1, 1}, {0, 0, 0, 1, 1, 0, 1, 1}, {1, 1, 1, 1, 1, 1, 1, 1}, {0, 1, 1, 1, 1, 1, 1, 0}
  , {0, 0, 0, 1, 1, 0, 0, 0}}
  , {{0, 0, 0, 0, 0, 0, 0, 0}, {0, 0, 0, 0, 0, 0, 0, 0}, {0, 1, 1, 1, 0, 0, 0, 0}, {1, 1, 0, 1, 1, 0, 0, 0}
  , {1, 1, 0, 1, 1, 0, 1, 1}, {0, 1, 1, 1, 0, 1, 1, 0}, {0, 0, 0, 0, 1, 1, 0, 0}, {0, 0, 0, 1, 1, 0, 0, 0}
  , {0, 0, 1, 1, 0, 0, 0, 0}, {0, 1, 1, 0, 1, 1, 1, 0}, {1, 1, 0, 1, 1, 0, 1, 1}, {0, 0, 0, 1, 1, 0, 1, 1}
  , {0, 0, 0, 0, 1, 1, 1, 0}}
  , {{0, 0, 0, 0, 0, 0, 0, 0}, {0, 0, 0, 0, 0, 0, 0, 0}, {1, 1, 1, 1, 1, 1, 1, 0}, {0, 1, 1, 0, 0, 0, 1, 1}
  , {1, 1, 1, 1, 0, 0, 1, 1}, {0, 0, 0, 1, 1, 0, 1, 1}, {0, 0, 0, 0, 1, 1, 1, 0}, {0, 0, 0, 0, 1, 1, 1, 0}
  , {0, 0, 0, 1, 1, 0, 1, 1}, {0, 0, 1, 1, 0, 0, 1, 1}, {0, 0, 1, 1, 0, 0, 1, 1}, {0, 0, 1, 1, 0, 1, 1, 0}
  , {0, 0, 0, 1, 1, 1, 0, 0}}
  , {{0, 0, 0, 0, 0, 0, 0, 0}, {0, 0, 0, 0, 0, 0, 0, 0}, {0, 0, 0, 0, 0, 0, 0, 0}, {0, 0, 0, 0, 0, 0, 0, 0}
  , {0, 0, 0, 0, 0, 0, 0, 0}, {0, 0, 0, 0, 0, 0, 0, 0}, {0, 0, 0, 0, 0, 0, 0, 0}, {0, 0, 0, 0, 0, 0, 0, 0}
  , {0, 0, 0, 0, 0, 0, 0, 0}, {0, 0, 0, 1, 1, 0, 0, 0}, {0, 0, 1, 1, 1, 0, 0, 0}, {0, 0, 1, 1, 0, 0, 0, 0}
  , {0, 1, 1, 1, 0, 0, 0, 0}}
  , {{0, 0, 0, 0, 0, 0, 0, 0}, {0, 0, 0, 0, 0, 0, 0, 0}, {0, 0, 1, 1, 0, 0, 0, 0}, {0, 0, 0, 1, 1, 0, 0, 0}
  , {0, 0, 0, 0, 1, 1, 0, 0}, {0, 0, 0, 0, 1, 1, 0, 0}, {0, 0, 0, 0, 1, 1, 0, 0}, {0, 0, 0, 0, 1, 1, 0, 0}
  , {0, 0, 0, 0, 1, 1, 0, 0}, {0, 0, 0, 0, 1, 1, 0, 0}, {0, 0, 0, 0, 1, 1, 0, 0}, {0, 0, 0, 1, 1, 0, 0, 0}
  , {0, 0, 1, 1, 0, 0, 0, 0}}
  , {{0, 0, 0, 0, 0, 0, 0, 0}, {0, 0, 0, 0, 0, 0, 0, 0}, {0, 0, 0, 0, 1, 1, 0, 0}, {0, 0, 0, 1, 1, 0, 0, 0}
  , {0, 0, 1, 1, 0, 0, 0, 0}, {0, 0, 1, 1, 0, 0, 0, 0}, {0, 0, 1, 1, 0, 0, 0, 0}, {0, 0, 1, 1, 0, 0, 0, 0}
  , {0, 0, 1, 1, 0, 0, 0, 0}, {0, 0, 1, 1, 0, 0, 0, 0}, {0, 0, 1, 1, 0, 0, 0, 0}, {0, 0, 0, 1, 1, 0, 0, 0}
  , {0, 0, 0, 0, 1, 1, 0, 0}}
  , {{0, 0, 0, 0, 0, 0, 0, 0}, {0, 0, 0, 0, 0, 0, 0, 0}, {0, 0, 0, 0, 0, 0, 0, 0}, {0, 0, 0, 0, 0, 0, 0, 0}
  , {1, 0, 0, 1, 1, 0, 0, 1}, {0, 1, 0, 1, 1, 0, 1, 0}, {0, 0, 1, 1, 1, 1, 0, 0}, {1, 1, 1, 1, 1, 1, 1, 1}
  , {0, 0, 1, 1, 1, 1, 0, 0}, {0, 1, 0, 1, 1, 0, 1, 0}, {1, 0, 0, 1, 1, 0, 0, 1}, {0, 0, 0, 0, 0, 0, 0, 0}
  , {0, 0, 0, 0, 0, 0, 0, 0}}
  , {{0, 0, 0, 0, 0, 0, 0, 0}, {0, 0, 0, 0, 0, 0, 0, 0}, {0, 0, 0, 0, 0, 0, 0, 0}, {0, 0, 0, 1, 1, 0, 0, 0}
  , {0, 0, 0, 1, 1, 0, 0, 0}, {0, 0, 0, 1, 1, 0, 0, 0}, {1, 1, 1, 1, 1, 1, 1, 1}, {1, 1, 1, 1, 1, 1, 1, 1}
  , {0, 0, 0, 1, 1, 0, 0, 0}, {0, 0, 0, 1, 1, 0, 0, 0}, {0, 0, 0, 1, 1, 0, 0, 0}, {0, 0, 0, 0, 0, 0, 0, 0}
  , {0, 0, 0, 0, 0, 0, 0, 0}}
  , {{0, 0, 0, 0, 0, 0, 0, 0}, {0, 0, 0, 0, 0, 0, 0, 0}, {0, 0, 0, 0, 1, 1, 0, 0}, {0, 0, 0, 1, 1, 0, 0, 0}
  , {0, 0, 1, 1, 1, 0, 0, 0}, {0, 0, 1, 1, 1, 0, 0, 0}, {0, 0, 0, 0, 0, 0, 0, 0}, {0, 0, 0, 0, 0, 0, 0, 0}
  , {0, 0, 0, 0, 0, 0, 0, 0}, {0, 0, 0, 0, 0, 0, 0, 0}, {0, 0, 0, 0, 0, 0, 0, 0}, {0, 0, 0, 0, 0, 0, 0, 0}
  , {0, 0, 0, 0, 0, 0, 0, 0}}
  , {{0, 0, 0, 0, 0, 0, 0, 0}, {0, 0, 0, 0, 0, 0, 0, 0}, {0, 0, 0, 0, 0, 0, 0, 0}, {0, 0, 0, 0, 0, 0, 0, 0}
  , {0, 0, 0, 0, 0, 0, 0, 0}, {0, 0, 0, 0, 0, 0, 0, 0}, {1, 1, 1, 1, 1, 1, 1, 1}, {1, 1, 1, 1, 1, 1, 1, 1}
  , {0, 0, 0, 0, 0, 0, 0, 0}, {0, 0, 0, 0, 0, 0, 0, 0}, {0, 0, 0, 0, 0, 0, 0, 0}, {0, 0, 0, 0, 0, 0, 0, 0}
  , {0, 0, 0, 0, 0, 0, 0, 0}}
  , {{0, 0, 0, 0, 0, 0, 0, 0}, {0, 0, 0, 0, 0, 0, 0, 0}, {0, 0, 0, 0, 0, 0, 0, 0}, {0, 0, 0, 1, 1, 1, 0, 0}
  , {0, 0, 0, 1, 1, 1, 0, 0}, {0, 0, 0, 0, 0, 0, 0, 0}, {0, 0, 0, 0, 0, 0, 0, 0}, {0, 0, 0, 0, 0, 0, 0, 0}
  , {0, 0, 0, 0, 0, 0, 0, 0}, {0, 0, 0, 0, 0, 0, 0, 0}, {0, 0, 0, 0, 0, 0, 0, 0}, {0, 0, 0, 0, 0, 0, 0, 0}
  , {0, 0, 0, 0, 0, 0, 0, 0}}
  , {{0, 0, 0, 0, 0, 0, 0, 0}, {0, 0, 0, 0, 0, 1, 1, 0}, {0, 0, 0, 0, 0, 1, 1, 0}, {0, 0, 0, 0, 1, 1, 0, 0}
  , {0, 0, 0, 0, 1, 1, 0, 0}, {0, 0, 0, 1, 1, 0, 0, 0}, {0, 0, 0, 1, 1, 0, 0, 0}, {0, 0, 1, 1, 0, 0, 0, 0}
  , {0, 0, 1, 1, 0, 0, 0, 0}, {0, 1, 1, 0, 0, 0, 0, 0}, {0, 1, 1, 0, 0, 0, 0, 0}, {1, 1, 0, 0, 0, 0, 0, 0}
  , {1, 1, 0, 0, 0, 0, 0, 0}}
  , {{0, 0, 0, 0, 0, 0, 0, 0}, {0, 0, 0, 0, 0, 0, 0, 0}, {0, 0, 1, 1, 1, 1, 0, 0}, {0, 1, 1, 0, 0, 1, 1, 0}
  , {1, 1, 0, 0, 0, 0, 1, 1}, {1, 1, 0, 0, 0, 1, 1, 1}, {1, 1, 0, 0, 1, 1, 1, 1}, {1, 1, 0, 1, 1, 0, 1, 1}
  , {1, 1, 1, 1, 0, 0, 1, 1}, {1, 1, 1, 0, 0, 0, 1, 1}, {1, 1, 0, 0, 0, 0, 1, 1}, {0, 1, 1, 0, 0, 1, 1, 0}
  , {0, 0, 1, 1, 1, 1, 0, 0}}
  , {{0, 0, 0, 0, 0, 0, 0, 0}, {0, 0, 0, 0, 0, 0, 0, 0}, {0, 1, 1, 1, 1, 1, 1, 0}, {0, 0, 0, 1, 1, 0, 0, 0}
  , {0, 0, 0, 1, 1, 0, 0, 0}, {0, 0, 0, 1, 1, 0, 0, 0}, {0, 0, 0, 1, 1, 0, 0, 0}, {0, 0, 0, 1, 1, 0, 0, 0}
  , {0, 0, 0, 1, 1, 0, 0, 0}, {0, 0, 0, 1, 1, 0, 0, 0}, {0, 0, 0, 1, 1, 1, 1, 0}, {0, 0, 0, 1, 1, 1, 0, 0}
  , {0, 0, 0, 1, 1, 0, 0, 0}}
  , {{0, 0, 0, 0, 0, 0, 0, 0}, {0, 0, 0, 0, 0, 0, 0, 0}, {1, 1, 1, 1, 1, 1, 1, 1}, {0, 0, 0, 0, 0, 0, 1, 1}
  , {0, 0, 0, 0, 0, 0, 1, 1}, {0, 0, 0, 0, 0, 1, 1, 0}, {0, 0, 0, 0, 1, 1, 0, 0}, {0, 0, 0, 1, 1, 0, 0, 0}
  , {0, 0, 1, 1, 0, 0, 0, 0}, {0, 1, 1, 0, 0, 0, 0, 0}, {1, 1, 0, 0, 0, 0, 0, 0}, {1, 1, 1, 0, 0, 1, 1, 1}
  , {0, 1, 1, 1, 1, 1, 1, 0}}
  , {{0, 0, 0, 0, 0, 0, 0, 0}, {0, 0, 0, 0, 0, 0, 0, 0}, {0, 1, 1, 1, 1, 1, 1, 0}, {1, 1, 1, 0, 0, 1, 1, 1}
  , {1, 1, 0, 0, 0, 0, 0, 0}, {1, 1, 0, 0, 0, 0, 0, 0}, {1, 1, 1, 0, 0, 0, 0, 0}, {0, 1, 1, 1, 1, 1, 1, 0}
  , {1, 1, 1, 0, 0, 0, 0, 0}, {1, 1, 0, 0, 0, 0, 0, 0}, {1, 1, 0, 0, 0, 0, 0, 0}, {1, 1, 1, 0, 0, 1, 1, 1}
  , {0, 1, 1, 1, 1, 1, 1, 0}}
  , {{0, 0, 0, 0, 0, 0, 0, 0}, {0, 0, 0, 0, 0, 0, 0, 0}, {0, 0, 1, 1, 0, 0, 0, 0}, {0, 0, 1, 1, 0, 0, 0, 0}
  , {0, 0, 1, 1, 0, 0, 0, 0}, {0, 0, 1, 1, 0, 0, 0, 0}, {0, 0, 1, 1, 0, 0, 0, 0}, {1, 1, 1, 1, 1, 1, 1, 1}
  , {0, 0, 1, 1, 0, 0, 1, 1}, {0, 0, 1, 1, 0, 1, 1, 0}, {0, 0, 1, 1, 1, 1, 0, 0}, {0, 0, 1, 1, 1, 0, 0, 0}
  , {0, 0, 1, 1, 0, 0, 0, 0}}
  , {{0, 0, 0, 0, 0, 0, 0, 0}, {0, 0, 0, 0, 0, 0, 0, 0}, {0, 1, 1, 1, 1, 1, 1, 0}, {1, 1, 1, 0, 0, 1, 1, 1}
  , {1, 1, 0, 0, 0, 0, 0, 0}, {1, 1, 0, 0, 0, 0, 0, 0}, {1, 1, 1, 0, 0, 0, 0, 0}, {0, 1, 1, 1, 1, 1, 1, 1}
  , {0, 0, 0, 0, 0, 0, 1, 1}, {0, 0, 0, 0, 0, 0, 1, 1}, {0, 0, 0, 0, 0, 0, 1, 1}, {0, 0, 0, 0, 0, 0, 1, 1}
  , {1, 1, 1, 1, 1, 1, 1, 1}}
  , {{0, 0, 0, 0, 0, 0, 0, 0}, {0, 0, 0, 0, 0, 0, 0, 0}, {0, 1, 1, 1, 1, 1, 1, 0}, {1, 1, 1, 0, 0, 1, 1, 1}
  , {1, 1, 0, 0, 0, 0, 1, 1}, {1, 1, 0, 0, 0, 0, 1, 1}, {1, 1, 1, 0, 0, 0, 1, 1}, {0, 1, 1, 1, 1, 1, 1, 1}
  , {0, 0, 0, 0, 0, 0, 1, 1}, {0, 0, 0, 0, 0, 0, 1, 1}, {0, 0, 0, 0, 0, 0, 1, 1}, {1, 1, 1, 0, 0, 1, 1, 1}
  , {0, 1, 1, 1, 1, 1, 1, 0}}
  , {{0, 0, 0, 0, 0, 0, 0, 0}, {0, 0, 0, 0, 0, 0, 0, 0}, {0, 0, 0, 0, 1, 1, 0, 0}, {0, 0, 0, 0, 1, 1, 0, 0}
  , {0, 0, 0, 0, 1, 1, 0, 0}, {0, 0, 0, 0, 1, 1, 0, 0}, {0, 0, 0, 1, 1, 0, 0, 0}, {0, 0, 1, 1, 0, 0, 0, 0}
  , {0, 1, 1, 0, 0, 0, 0, 0}, {1, 1, 0, 0, 0, 0, 0, 0}, {1, 1, 0, 0, 0, 0, 0, 0}, {1, 1, 0, 0, 0, 0, 0, 0}
  , {1, 1, 1, 1, 1, 1, 1, 1}}
  , {{0, 0, 0, 0, 0, 0, 0, 0}, {0, 0, 0, 0, 0, 0, 0, 0}, {0, 1, 1, 1, 1, 1, 1, 0}, {1, 1, 1, 0, 0, 1, 1, 1}
  , {1, 1, 0, 0, 0, 0, 1, 1}, {1, 1, 0, 0, 0, 0, 1, 1}, {1, 1, 1, 0, 0, 1, 1, 1}, {0, 1, 1, 1, 1, 1, 1, 0}
  , {1, 1, 1, 0, 0, 1, 1, 1}, {1, 1, 0, 0, 0, 0, 1, 1}, {1, 1, 0, 0, 0, 0, 1, 1}, {1, 1, 1, 0, 0, 1, 1, 1}
  , {0, 1, 1, 1, 1, 1, 1, 0}}
  , {{0, 0, 0, 0, 0, 0, 0, 0}, {0, 0, 0, 0, 0, 0, 0, 0}, {0, 1, 1, 1, 1, 1, 1, 0}, {1, 1, 1, 0, 0, 1, 1, 1}
  , {1, 1, 0, 0, 0, 0, 0, 0}, {1, 1, 0, 0, 0, 0, 0, 0}, {1, 1, 0, 0, 0, 0, 0, 0}, {1, 1, 1, 1, 1, 1, 1, 0}
  , {1, 1, 1, 0, 0, 1, 1, 1}, {1, 1, 0, 0, 0, 0, 1, 1}, {1, 1, 0, 0, 0, 0, 1, 1}, {1, 1, 1, 0, 0, 1, 1, 1}
  , {0, 1, 1, 1, 1, 1, 1, 0}}
  , {{0, 0, 0, 0, 0, 0, 0, 0}, {0, 0, 0, 0, 0, 0, 0, 0}, {0, 0, 0, 0, 0, 0, 0, 0}, {0, 0, 0, 1, 1, 1, 0, 0}
  , {0, 0, 0, 1, 1, 1, 0, 0}, {0, 0, 0, 0, 0, 0, 0, 0}, {0, 0, 0, 0, 0, 0, 0, 0}, {0, 0, 0, 1, 1, 1, 0, 0}
  , {0, 0, 0, 1, 1, 1, 0, 0}, {0, 0, 0, 0, 0, 0, 0, 0}, {0, 0, 0, 0, 0, 0, 0, 0}, {0, 0, 0, 0, 0, 0, 0, 0}
  , {0, 0, 0, 0, 0, 0, 0, 0}}
  , {{0, 0, 0, 0, 0, 0, 0, 0}, {0, 0, 0, 0, 0, 0, 0, 0}, {0, 0, 0, 0, 1, 1, 0, 0}, {0, 0, 0, 1, 1, 0, 0, 0}
  , {0, 0, 1, 1, 1, 0, 0, 0}, {0, 0, 1, 1, 1, 0, 0, 0}, {0, 0, 0, 0, 0, 0, 0, 0}, {0, 0, 0, 0, 0, 0, 0, 0}
  , {0, 0, 1, 1, 1, 0, 0, 0}, {0, 0, 1, 1, 1, 0, 0, 0}, {0, 0, 0, 0, 0, 0, 0, 0}, {0, 0, 0, 0, 0, 0, 0, 0}
  , {0, 0, 0, 0, 0, 0, 0, 0}}
  , {{0, 0, 0, 0, 0, 0, 0, 0}, {0, 0, 0, 0, 0, 0, 0, 0}, {0, 1, 1, 0, 0, 0, 0, 0}, {0, 0, 1, 1, 0, 0, 0, 0}
  , {0, 0, 0, 1, 1, 0, 0, 0}, {0, 0, 0, 0, 1, 1, 0, 0}, {0, 0, 0, 0, 0, 1, 1, 0}, {0, 0, 0, 0, 0, 0, 1, 1}
  , {0, 0, 0, 0, 0, 1, 1, 0}, {0, 0, 0, 0, 1, 1, 0, 0}, {0, 0, 0, 1, 1, 0, 0, 0}, {0, 0, 1, 1, 0, 0, 0, 0}
  , {0, 1, 1, 0, 0, 0, 0, 0}}
  , {{0, 0, 0, 0, 0, 0, 0, 0}, {0, 0, 0, 0, 0, 0, 0, 0}, {0, 0, 0, 0, 0, 0, 0, 0}, {0, 0, 0, 0, 0, 0, 0, 0}
  , {1, 1, 1, 1, 1, 1, 1, 1}, {1, 1, 1, 1, 1, 1, 1, 1}, {0, 0, 0, 0, 0, 0, 0, 0}, {1, 1, 1, 1, 1, 1, 1, 1}
  , {1, 1, 1, 1, 1, 1, 1, 1}, {0, 0, 0, 0, 0, 0, 0, 0}, {0, 0, 0, 0, 0, 0, 0, 0}, {0, 0, 0, 0, 0, 0, 0, 0}
  , {0, 0, 0, 0, 0, 0, 0, 0}}
  , {{0, 0, 0, 0, 0, 0, 0, 0}, {0, 0, 0, 0, 0, 0, 0, 0}, {0, 0, 0, 0, 0, 1, 1, 0}, {0, 0, 0, 0, 1, 1, 0, 0}
  , {0, 0, 0, 1, 1, 0, 0, 0}, {0, 0, 1, 1, 0, 0, 0, 0}, {0, 1, 1, 0, 0, 0, 0, 0}, {1, 1, 0, 0, 0, 0, 0, 0}
  , {0, 1, 1, 0, 0, 0, 0, 0}, {0, 0, 1, 1, 0, 0, 0, 0}, {0, 0, 0, 1, 1, 0, 0, 0}, {0, 0, 0, 0, 1, 1, 0, 0}
  , {0, 0, 0, 0, 0, 1, 1, 0}}
  , {{0, 0, 0, 0, 0, 0, 0, 0}, {0, 0, 0, 0, 0, 0, 0, 0}, {0, 0, 0, 1, 1, 0, 0, 0}, {0, 0, 0, 0, 0, 0, 0, 0}
  , {0, 0, 0, 0, 0, 0, 0, 0}, {0, 0, 0, 1, 1, 0, 0, 0}, {0, 0, 0, 1, 1, 0, 0, 0}, {0, 0, 1, 1, 0, 0, 0, 0}
  , {0, 1, 1, 0, 0, 0, 0, 0}, {1, 1, 0, 0, 0, 0, 0, 0}, {1, 1, 0, 0, 0, 0, 1, 1}, {1, 1, 0, 0, 0, 0, 1, 1}
  , {0, 1, 1, 1, 1, 1, 1, 0}}
  , {{0, 0, 0, 0, 0, 0, 0, 0}, {0, 0, 0, 0, 0, 0, 0, 0}, {1, 1, 1, 1, 1, 1, 0, 0}, {0, 0, 0, 0, 0, 1, 1, 0}
  , {1, 1, 1, 1, 0, 0, 1, 1}, {1, 1, 0, 1, 1, 0, 1, 1}, {1, 1, 0, 0, 1, 0, 1, 1}, {1, 0, 1, 1, 1, 0, 1, 1}
  , {1, 1, 0, 0, 0, 0, 1, 1}, {0, 1, 1, 1, 1, 1, 1, 0}, {0, 0, 0, 0, 0, 0, 0, 0}, {0, 0, 0, 0, 0, 0, 0, 0}
  , {0, 0, 0, 0, 0, 0, 0, 0}}
  , {{0, 0, 0, 0, 0, 0, 0, 0}, {0, 0, 0, 0, 0, 0, 0, 0}, {1, 1, 0, 0, 0, 0, 1, 1}, {1, 1, 0, 0, 0, 0, 1, 1}
  , {1, 1, 0, 0, 0, 0, 1, 1}, {1, 1, 0, 0, 0, 0, 1, 1}, {1, 1, 1, 1, 1, 1, 1, 1}, {1, 1, 0, 0, 0, 0, 1, 1}
  , {1, 1, 0, 0, 0, 0, 1, 1}, {1, 1, 0, 0, 0, 0, 1, 1}, {0, 1, 1, 0, 0, 1, 1, 0}, {0, 0, 1, 1, 1, 1, 0, 0}
  , {0, 0, 0, 1, 1, 0, 0, 0}}
  , {{0, 0, 0, 0, 0, 0, 0, 0}, {0, 0, 0, 0, 0, 0, 0, 0}, {0, 1, 1, 1, 1, 1, 1, 1}, {1, 1, 1, 0, 0, 0, 1, 1}
  , {1, 1, 0, 0, 0, 0, 1, 1}, {1, 1, 0, 0, 0, 0, 1, 1}, {1, 1, 1, 0, 0, 0, 1, 1}, {0, 1, 1, 1, 1, 1, 1, 1}
  , {1, 1, 1, 0, 0, 0, 1, 1}, {1, 1, 0, 0, 0, 0, 1, 1}, {1, 1, 0, 0, 0, 0, 1, 1}, {1, 1, 1, 0, 0, 0, 1, 1}
  , {0, 1, 1, 1, 1, 1, 1, 1}}
  , {{0, 0, 0, 0, 0, 0, 0, 0}, {0, 0, 0, 0, 0, 0, 0, 0}, {0, 1, 1, 1, 1, 1, 1, 0}, {1, 1, 1, 0, 0, 1, 1, 1}
  , {0, 0, 0, 0, 0, 0, 1, 1}, {0, 0, 0, 0, 0, 0, 1, 1}, {0, 0, 0, 0, 0, 0, 1, 1}, {0, 0, 0, 0, 0, 0, 1, 1}
  , {0, 0, 0, 0, 0, 0, 1, 1}, {0, 0, 0, 0, 0, 0, 1, 1}, {0, 0, 0, 0, 0, 0, 1, 1}, {1, 1, 1, 0, 0, 1, 1, 1}
  , {0, 1, 1, 1, 1, 1, 1, 0}}
  , {{0, 0, 0, 0, 0, 0, 0, 0}, {0, 0, 0, 0, 0, 0, 0, 0}, {0, 0, 1, 1, 1, 1, 1, 1}, {0, 1, 1, 1, 0, 0, 1, 1}
  , {1, 1, 1, 0, 0, 0, 1, 1}, {1, 1, 0, 0, 0, 0, 1, 1}, {1, 1, 0, 0, 0, 0, 1, 1}, {1, 1, 0, 0, 0, 0, 1, 1}
  , {1, 1, 0, 0, 0, 0, 1, 1}, {1, 1, 0, 0, 0, 0, 1, 1}, {1, 1, 1, 0, 0, 0, 1, 1}, {0, 1, 1, 1, 0, 0, 1, 1}
  , {0, 0, 1, 1, 1, 1, 1, 1}}
  , {{0, 0, 0, 0, 0, 0, 0, 0}, {0, 0, 0, 0, 0, 0, 0, 0}, {1, 1, 1, 1, 1, 1, 1, 1}, {0, 0, 0, 0, 0, 0, 1, 1}
  , {0, 0, 0, 0, 0, 0, 1, 1}, {0, 0, 0, 0, 0, 0, 1, 1}, {0, 0, 0, 0, 0, 0, 1, 1}, {0, 0, 1, 1, 1, 1, 1, 1}
  , {0, 0, 0, 0, 0, 0, 1, 1}, {0, 0, 0, 0, 0, 0, 1, 1}, {0, 0, 0, 0, 0, 0, 1, 1}, {0, 0, 0, 0, 0, 0, 1, 1}
  , {1, 1, 1, 1, 1, 1, 1, 1}}
  , {{0, 0, 0, 0, 0, 0, 0, 0}, {0, 0, 0, 0, 0, 0, 0, 0}, {0, 0, 0, 0, 0, 0, 1, 1}, {0, 0, 0, 0, 0, 0, 1, 1}
  , {0, 0, 0, 0, 0, 0, 1, 1}, {0, 0, 0, 0, 0, 0, 1, 1}, {0, 0, 0, 0, 0, 0, 1, 1}, {0, 0, 0, 0, 0, 0, 1, 1}
  , {0, 0, 1, 1, 1, 1, 1, 1}, {0, 0, 0, 0, 0, 0, 1, 1}, {0, 0, 0, 0, 0, 0, 1, 1}, {0, 0, 0, 0, 0, 0, 1, 1}
  , {1, 1, 1, 1, 1, 1, 1, 1}}
  , {{0, 0, 0, 0, 0, 0, 0, 0}, {0, 0, 0, 0, 0, 0, 0, 0}, {0, 1, 1, 1, 1, 1, 1, 0}, {1, 1, 1, 0, 0, 1, 1, 1}
  , {1, 1, 0, 0, 0, 0, 1, 1}, {1, 1, 0, 0, 0, 0, 1, 1}, {1, 1, 1, 1, 0, 0, 1, 1}, {0, 0, 0, 0, 0, 0, 1, 1}
  , {0, 0, 0, 0, 0, 0, 1, 1}, {0, 0, 0, 0, 0, 0, 1, 1}, {0, 0, 0, 0, 0, 0, 1, 1}, {1, 1, 1, 0, 0, 1, 1, 1}
  , {0, 1, 1, 1, 1, 1, 1, 0}}
  , {{0, 0, 0, 0, 0, 0, 0, 0}, {0, 0, 0, 0, 0, 0, 0, 0}, {1, 1, 0, 0, 0, 0, 1, 1}, {1, 1, 0, 0, 0, 0, 1, 1}
  , {1, 1, 0, 0, 0, 0, 1, 1}, {1, 1, 0, 0, 0, 0, 1, 1}, {1, 1, 0, 0, 0, 0, 1, 1}, {1, 1, 1, 1, 1, 1, 1, 1}
  , {1, 1, 0, 0, 0, 0, 1, 1}, {1, 1, 0, 0, 0, 0, 1, 1}, {1, 1, 0, 0, 0, 0, 1, 1}, {1, 1, 0, 0, 0, 0, 1, 1}
  , {1, 1, 0, 0, 0, 0, 1, 1}}
  , {{0, 0, 0, 0, 0, 0, 0, 0}, {0, 0, 0, 0, 0, 0, 0, 0}, {0, 1, 1, 1, 1, 1, 1, 0}, {0, 0, 0, 1, 1, 0, 0, 0}
  , {0, 0, 0, 1, 1, 0, 0, 0}, {0, 0, 0, 1, 1, 0, 0, 0}, {0, 0, 0, 1, 1, 0, 0, 0}, {0, 0, 0, 1, 1, 0, 0, 0}
  , {0, 0, 0, 1, 1, 0, 0, 0}, {0, 0, 0, 1, 1, 0, 0, 0}, {0, 0, 0, 1, 1, 0, 0, 0}, {0, 0, 0, 1, 1, 0, 0, 0}
  , {0, 1, 1, 1, 1, 1, 1, 0}}
  , {{0, 0, 0, 0, 0, 0, 0, 0}, {0, 0, 0, 0, 0, 0, 0, 0}, {0, 0, 1, 1, 1, 1, 1, 0}, {0, 1, 1, 1, 0, 1, 1, 1}
  , {0, 1, 1, 0, 0, 0, 1, 1}, {0, 1, 1, 0, 0, 0, 0, 0}, {0, 1, 1, 0, 0, 0, 0, 0}, {0, 1, 1, 0, 0, 0, 0, 0}
  , {0, 1, 1, 0, 0, 0, 0, 0}, {0, 1, 1, 0, 0, 0, 0, 0}, {0, 1, 1, 0, 0, 0, 0, 0}, {0, 1, 1, 0, 0, 0, 0, 0}
  , {0, 1, 1, 0, 0, 0, 0, 0}}
  , {{0, 0, 0, 0, 0, 0, 0, 0}, {0, 0, 0, 0, 0, 0, 0, 0}, {1, 1, 0, 0, 0, 0, 1, 1}, {0, 1, 1, 0, 0, 0, 1, 1}
  , {0, 0, 1, 1, 0, 0, 1, 1}, {0, 0, 0, 1, 1, 0, 1, 1}, {0, 0, 0, 0, 1, 1, 1, 1}, {0, 0, 0, 0, 0, 1, 1, 1}
  , {0, 0, 0, 0, 1, 1, 1, 1}, {0, 0, 0, 1, 1, 0, 1, 1}, {0, 0, 1, 1, 0, 0, 1, 1}, {0, 1, 1, 0, 0, 0, 1, 1}
  , {1, 1, 0, 0, 0, 0, 1, 1}}
  , {{0, 0, 0, 0, 0, 0, 0, 0}, {0, 0, 0, 0, 0, 0, 0, 0}, {1, 1, 1, 1, 1, 1, 1, 1}, {0, 0, 0, 0, 0, 0, 1, 1}
  , {0, 0, 0, 0, 0, 0, 1, 1}, {0, 0, 0, 0, 0, 0, 1, 1}, {0, 0, 0, 0, 0, 0, 1, 1}, {0, 0, 0, 0, 0, 0, 1, 1}
  , {0, 0, 0, 0, 0, 0, 1, 1}, {0, 0, 0, 0, 0, 0, 1, 1}, {0, 0, 0, 0, 0, 0, 1, 1}, {0, 0, 0, 0, 0, 0, 1, 1}
  , {0, 0, 0, 0, 0, 0, 1, 1}}
  , {{0, 0, 0, 0, 0, 0, 0, 0}, {0, 0, 0, 0, 0, 0, 0, 0}, {1, 1, 0, 0, 0, 0, 1, 1}, {1, 1, 0, 0, 0, 0, 1, 1}
  , {1, 1, 0, 0, 0, 0, 1, 1}, {1, 1, 0, 0, 0, 0, 1, 1}, {1, 1, 0, 0, 0, 0, 1, 1}, {1, 1, 0, 0, 0, 0, 1, 1}
  , {1, 1, 0, 1, 1, 0, 1, 1}, {1, 1, 1, 1, 1, 1, 1, 1}, {1, 1, 1, 1, 1, 1, 1, 1}, {1, 1, 1, 0, 0, 1, 1, 1}
  , {1, 1, 0, 0, 0, 0, 1, 1}}
  , {{0, 0, 0, 0, 0, 0, 0, 0}, {0, 0, 0, 0, 0, 0, 0, 0}, {1, 1, 1, 0, 0, 0, 1, 1}, {1, 1, 1, 0, 0, 0, 1, 1}
  , {1, 1, 1, 1, 0, 0, 1, 1}, {1, 1, 1, 1, 0, 0, 1, 1}, {1, 1, 1, 1, 1, 0, 1, 1}, {1, 1, 0, 1, 1, 0, 1, 1}
  , {1, 1, 0, 1, 1, 1, 1, 1}, {1, 1, 0, 0, 1, 1, 1, 1}, {1, 1, 0, 0, 1, 1, 1, 1}, {1, 1, 0, 0, 0, 1, 1, 1}
  , {1, 1, 0, 0, 0, 1, 1, 1}}
  , {{0, 0, 0, 0, 0, 0, 0, 0}, {0, 0, 0, 0, 0, 0, 0, 0}, {0, 1, 1, 1, 1, 1, 1, 0}, {1, 1, 1, 0, 0, 1, 1, 1}
  , {1, 1, 0, 0, 0, 0, 1, 1}, {1, 1, 0, 0, 0, 0, 1, 1}, {1, 1, 0, 0, 0, 0, 1, 1}, {1, 1, 0, 0, 0, 0, 1, 1}
  , {1, 1, 0, 0, 0, 0, 1, 1}, {1, 1, 0, 0, 0, 0, 1, 1}, {1, 1, 0, 0, 0, 0, 1, 1}, {1, 1, 1, 0, 0, 1, 1, 1}
  , {0, 1, 1, 1, 1, 1, 1, 0}}
  , {{0, 0, 0, 0, 0, 0, 0, 0}, {0, 0, 0, 0, 0, 0, 0, 0}, {0, 0, 0, 0, 0, 0, 1, 1}, {0, 0, 0, 0, 0, 0, 1, 1}
  , {0, 0, 0, 0, 0, 0, 1, 1}, {0, 0, 0, 0, 0, 0, 1, 1}, {0, 0, 0, 0, 0, 0, 1, 1}, {0, 1, 1, 1, 1, 1, 1, 1}
  , {1, 1, 1, 0, 0, 0, 1, 1}, {1, 1, 0, 0, 0, 0, 1, 1}, {1, 1, 0, 0, 0, 0, 1, 1}, {1, 1, 1, 0, 0, 0, 1, 1}
  , {0, 1, 1, 1, 1, 1, 1, 1}}
  , {{0, 0, 0, 0, 0, 0, 0, 0}, {0, 0, 0, 0, 0, 0, 0, 0}, {1, 1, 1, 1, 1, 1, 0, 0}, {0, 1, 1, 1, 0, 1, 1, 0}
  , {1, 1, 1, 1, 1, 0, 1, 1}, {1, 1, 0, 1, 1, 0, 1, 1}, {1, 1, 0, 0, 0, 0, 1, 1}, {1, 1, 0, 0, 0, 0, 1, 1}
  , {1, 1, 0, 0, 0, 0, 1, 1}, {1, 1, 0, 0, 0, 0, 1, 1}, {1, 1, 0, 0, 0, 0, 1, 1}, {0, 1, 1, 0, 0, 1, 1, 0}
  , {0, 0, 1, 1, 1, 1, 0, 0}}
  , {{0, 0, 0, 0, 0, 0, 0, 0}, {0, 0, 0, 0, 0, 0, 0, 0}, {1, 1, 0, 0, 0, 0, 1, 1}, {0, 1, 1, 0, 0, 0, 1, 1}
  , {0, 0, 1, 1, 0, 0, 1, 1}, {0, 0, 0, 1, 1, 0, 1, 1}, {0, 0, 0, 0, 1, 1, 1, 1}, {0, 1, 1, 1, 1, 1, 1, 1}
  , {1, 1, 1, 0, 0, 0, 1, 1}, {1, 1, 0, 0, 0, 0, 1, 1}, {1, 1, 0, 0, 0, 0, 1, 1}, {1, 1, 1, 0, 0, 0, 1, 1}
  , {0, 1, 1, 1, 1, 1, 1, 1}}
  , {{0, 0, 0, 0, 0, 0, 0, 0}, {0, 0, 0, 0, 0, 0, 0, 0}, {0, 1, 1, 1, 1, 1, 1, 0}, {1, 1, 1, 0, 0, 1, 1, 1}
  , {1, 1, 0, 0, 0, 0, 0, 0}, {1, 1, 0, 0, 0, 0, 0, 0}, {1, 1, 1, 0, 0, 0, 0, 0}, {0, 1, 1, 1, 1, 1, 1, 0}
  , {0, 0, 0, 0, 0, 1, 1, 1}, {0, 0, 0, 0, 0, 0, 1, 1}, {0, 0, 0, 0, 0, 0, 1, 1}, {1, 1, 1, 0, 0, 1, 1, 1}
  , {0, 1, 1, 1, 1, 1, 1, 0}}
  , {{0, 0, 0, 0, 0, 0, 0, 0}, {0, 0, 0, 0, 0, 0, 0, 0}, {0, 0, 0, 1, 1, 0, 0, 0}, {0, 0, 0, 1, 1, 0, 0, 0}
  , {0, 0, 0, 1, 1, 0, 0, 0}, {0, 0, 0, 1, 1, 0, 0, 0}, {0, 0, 0, 1, 1, 0, 0, 0}, {0, 0, 0, 1, 1, 0, 0, 0}
  , {0, 0, 0, 1, 1, 0, 0, 0}, {0, 0, 0, 1, 1, 0, 0, 0}, {0, 0, 0, 1, 1, 0, 0, 0}, {0, 0, 0, 1, 1, 0, 0, 0}
  , {1, 1, 1, 1, 1, 1, 1, 1}}
  , {{0, 0, 0, 0, 0, 0, 0, 0}, {0, 0, 0, 0, 0, 0, 0, 0}, {0, 1, 1, 1, 1, 1, 1, 0}, {1, 1, 1, 0, 0, 1, 1, 1}
  , {1, 1, 0, 0, 0, 0, 1, 1}, {1, 1, 0, 0, 0, 0, 1, 1}, {1, 1, 0, 0, 0, 0, 1, 1}, {1, 1, 0, 0, 0, 0, 1, 1}
  , {1, 1, 0, 0, 0, 0, 1, 1}, {1, 1, 0, 0, 0, 0, 1, 1}, {1, 1, 0, 0, 0, 0, 1, 1}, {1, 1, 0, 0, 0, 0, 1, 1}
  , {1, 1, 0, 0, 0, 0, 1, 1}}
  , {{0, 0, 0, 0, 0, 0, 0, 0}, {0, 0, 0, 0, 0, 0, 0, 0}, {0, 0, 0, 1, 1, 0, 0, 0}, {0, 0, 1, 1, 1, 1, 0, 0}
  , {0, 0, 1, 1, 1, 1, 0, 0}, {0, 1, 1, 0, 0, 1, 1, 0}, {0, 1, 1, 0, 0, 1, 1, 0}, {1, 1, 0, 0, 0, 0, 1, 1}
  , {1, 1, 0, 0, 0, 0, 1, 1}, {1, 1, 0, 0, 0, 0, 1, 1}, {1, 1, 0, 0, 0, 0, 1, 1}, {1, 1, 0, 0, 0, 0, 1, 1}
  , {1, 1, 0, 0, 0, 0, 1, 1}}
  , {{0, 0, 0, 0, 0, 0, 0, 0}, {0, 0, 0, 0, 0, 0, 0, 0}, {1, 1, 0, 0, 0, 0, 1, 1}, {1, 1, 1, 0, 0, 1, 1, 1}
  , {1, 1, 1, 1, 1, 1, 1, 1}, {1, 1, 1, 1, 1, 1, 1, 1}, {1, 1, 0, 1, 1, 0, 1, 1}, {1, 1, 0, 1, 1, 0, 1, 1}
  , {1, 1, 0, 0, 0, 0, 1, 1}, {1, 1, 0, 0, 0, 0, 1, 1}, {1, 1, 0, 0, 0, 0, 1, 1}, {1, 1, 0, 0, 0, 0, 1, 1}
  , {1, 1, 0, 0, 0, 0, 1, 1}}
  , {{0, 0, 0, 0, 0, 0, 0, 0}, {0, 0, 0, 0, 0, 0, 0, 0}, {1, 1, 0, 0, 0, 0, 1, 1}, {0, 1, 1, 0, 0, 1, 1, 0}
  , {0, 1, 1, 0, 0, 1, 1, 0}, {0, 0, 1, 1, 1, 1, 0, 0}, {0, 0, 1, 1, 1, 1, 0, 0}, {0, 0, 0, 1, 1, 0, 0, 0}
  , {0, 0, 1, 1, 1, 1, 0, 0}, {0, 0, 1, 1, 1, 1, 0, 0}, {0, 1, 1, 0, 0, 1, 1, 0}, {0, 1, 1, 0, 0, 1, 1, 0}
  , {1, 1, 0, 0, 0, 0, 1, 1}}
  , {{0, 0, 0, 0, 0, 0, 0, 0}, {0, 0, 0, 0, 0, 0, 0, 0}, {0, 0, 0, 1, 1, 0, 0, 0}, {0, 0, 0, 1, 1, 0, 0, 0}
  , {0, 0, 0, 1, 1, 0, 0, 0}, {0, 0, 0, 1, 1, 0, 0, 0}, {0, 0, 0, 1, 1, 0, 0, 0}, {0, 0, 0, 1, 1, 0, 0, 0}
  , {0, 0, 1, 1, 1, 1, 0, 0}, {0, 0, 1, 1, 1, 1, 0, 0}, {0, 1, 1, 0, 0, 1, 1, 0}, {0, 1, 1, 0, 0, 1, 1, 0}
  , {1, 1, 0, 0, 0, 0, 1, 1}}
  , {{0, 0, 0, 0, 0, 0, 0, 0}, {0, 0, 0, 0, 0, 0, 0, 0}, {1, 1, 1, 1, 1, 1, 1, 1}, {0, 0, 0, 0, 0, 0, 1, 1}
  , {0, 0, 0, 0, 0, 0, 1, 1}, {0, 0, 0, 0, 0, 1, 1, 0}, {0, 0, 0, 0, 1, 1, 0, 0}, {0, 1, 1, 1, 1, 1, 1, 0}
  , {0, 0, 1, 1, 0, 0, 0, 0}, {0, 1, 1, 0, 0, 0, 0, 0}, {1, 1, 0, 0, 0, 0, 0, 0}, {1, 1, 0, 0, 0, 0, 0, 0}
  , {1, 1, 1, 1, 1, 1, 1, 1}}
  , {{0, 0, 0, 0, 0, 0, 0, 0}, {0, 0, 0, 0, 0, 0, 0, 0}, {0, 0, 1, 1, 1, 1, 0, 0}, {0, 0, 0, 0, 1, 1, 0, 0}
  , {0, 0, 0, 0, 1, 1, 0, 0}, {0, 0, 0, 0, 1, 1, 0, 0}, {0, 0, 0, 0, 1, 1, 0, 0}, {0, 0, 0, 0, 1, 1, 0, 0}
  , {0, 0, 0, 0, 1, 1, 0, 0}, {0, 0, 0, 0, 1, 1, 0, 0}, {0, 0, 0, 0, 1, 1, 0, 0}, {0, 0, 0, 0, 1, 1, 0, 0}
  , {0, 0, 1, 1, 1, 1, 0, 0}}
  , {{0, 0, 0, 0, 0, 0, 0, 0}, {1, 1, 0, 0, 0, 0, 0, 0}, {1, 1, 0, 0, 0, 0, 0, 0}, {0, 1, 1, 0, 0, 0, 0, 0}
  , {0, 1, 1, 0, 0, 0, 0, 0}, {0, 0, 1, 1, 0, 0, 0, 0}, {0, 0, 1, 1, 0, 0, 0, 0}, {0, 0, 0, 1, 1, 0, 0, 0}
  , {0, 0, 0, 1, 1, 0, 0, 0}, {0, 0, 0, 0, 1, 1, 0, 0}, {0, 0, 0, 0, 1, 1, 0, 0}, {0, 0, 0, 0, 0, 1, 1, 0}
  , {0, 0, 0, 0, 0, 1, 1, 0}}
  , {{0, 0, 0, 0, 0, 0, 0, 0}, {0, 0, 0, 0, 0, 0, 0, 0}, {0, 0, 1, 1, 1, 1, 0, 0}, {0, 0, 1, 1, 0, 0, 0, 0}
  , {0, 0, 1, 1, 0, 0, 0, 0}, {0, 0, 1, 1, 0, 0, 0, 0}, {0, 0, 1, 1, 0, 0, 0, 0}, {0, 0, 1, 1, 0, 0, 0, 0}
  , {0, 0, 1, 1, 0, 0, 0, 0}, {0, 0, 1, 1, 0, 0, 0, 0}, {0, 0, 1, 1, 0, 0, 0, 0}, {0, 0, 1, 1, 0, 0, 0, 0}
  , {0, 0, 1, 1, 1, 1, 0, 0}}
  , {{0, 0, 0, 0, 0, 0, 0, 0}, {0, 0, 0, 0, 0, 0, 0, 0}, {0, 0, 0, 0, 0, 0, 0, 0}, {0, 0, 0, 0, 0, 0, 0, 0}
  , {0, 0, 0, 0, 0, 0, 0, 0}, {0, 0, 0, 0, 0, 0, 0, 0}, {0, 0, 0, 0, 0, 0, 0, 0}, {0, 0, 0, 0, 0, 0, 0, 0}
  , {0, 0, 0, 0, 0, 0, 0, 0}, {1, 1, 0, 0, 0, 0, 1, 1}, {0, 1, 1, 0, 0, 1, 1, 0}, {0, 0, 1, 1, 1, 1, 0, 0}
  , {0, 0, 0, 1, 1, 0, 0, 0}}
  , {{1, 1, 1, 1, 1, 1, 1, 1}, {1, 1, 1, 1, 1, 1, 1, 1}, {0, 0, 0, 0, 0, 0, 0, 0}, {0, 0, 0, 0, 0, 0, 0, 0}
  , {0, 0, 0, 0, 0, 0, 0, 0}, {0, 0, 0, 0, 0, 0, 0, 0}, {0, 0, 0, 0, 0, 0, 0, 0}, {0, 0, 0, 0, 0, 0, 0, 0}
  , {0, 0, 0, 0, 0, 0, 0, 0}, {0, 0, 0, 0, 0, 0, 0, 0}, {0, 0, 0, 0, 0, 0, 0, 0}, {0, 0, 0, 0, 0, 0, 0, 0}
  , {0, 0, 0, 0, 0, 0, 0, 0}}
  , {{0, 0, 0, 0, 0, 0, 0, 0}, {0, 0, 0, 0, 0, 0, 0, 0}, {0, 0, 0, 0, 0, 0, 0, 0}, {0, 0, 0, 0, 0, 0, 0, 0}
  , {0, 0, 0, 0, 0, 0, 0, 0}, {0, 0, 0, 0, 0, 0, 0, 0}, {0, 0, 0, 0, 0, 0, 0, 0}, {0, 0, 0, 0, 0, 0, 0, 0}
  , {0, 0, 0, 0, 0, 0, 0, 0}, {0, 0, 0, 1, 1, 0, 0, 0}, {0, 0, 0, 1, 1, 1, 0, 0}, {0, 0, 0, 0, 1, 1, 0, 0}
  , {0, 0, 0, 0, 1, 1, 1, 0}}
  , {{0, 0, 0, 0, 0, 0, 0, 0}, {0, 0, 0, 0, 0, 0, 0, 0}, {1, 1, 1, 1, 1, 1, 1, 0}, {1, 1, 0, 0, 0, 0, 1, 1}
  , {1, 1, 0, 0, 0, 0, 1, 1}, {1, 1, 1, 1, 1, 1, 1, 0}, {1, 1, 0, 0, 0, 0, 0, 0}, {1, 1, 0, 0, 0, 0, 1, 1}
  , {0, 1, 1, 1, 1, 1, 1, 0}, {0, 0, 0, 0, 0, 0, 0, 0}, {0, 0, 0, 0, 0, 0, 0, 0}, {0, 0, 0, 0, 0, 0, 0, 0}
  , {0, 0, 0, 0, 0, 0, 0, 0}}
  , {{0, 0, 0, 0, 0, 0, 0, 0}, {0, 0, 0, 0, 0, 0, 0, 0}, {0, 1, 1, 1, 1, 1, 1, 1}, {1, 1, 0, 0, 0, 0, 1, 1}
  , {1, 1, 0, 0, 0, 0, 1, 1}, {1, 1, 0, 0, 0, 0, 1, 1}, {1, 1, 0, 0, 0, 0, 1, 1}, {0, 1, 1, 1, 1, 1, 1, 1}
  , {0, 0, 0, 0, 0, 0, 1, 1}, {0, 0, 0, 0, 0, 0, 1, 1}, {0, 0, 0, 0, 0, 0, 1, 1}, {0, 0, 0, 0, 0, 0, 1, 1}
  , {0, 0, 0, 0, 0, 0, 1, 1}}
  , {{0, 0, 0, 0, 0, 0, 0, 0}, {0, 0, 0, 0, 0, 0, 0, 0}, {0, 1, 1, 1, 1, 1, 1, 0}, {1, 1, 0, 0, 0, 0, 1, 1}
  , {0, 0, 0, 0, 0, 0, 1, 1}, {0, 0, 0, 0, 0, 0, 1, 1}, {0, 0, 0, 0, 0, 0, 1, 1}, {1, 1, 0, 0, 0, 0, 1, 1}
  , {0, 1, 1, 1, 1, 1, 1, 0}, {0, 0, 0, 0, 0, 0, 0, 0}, {0, 0, 0, 0, 0, 0, 0, 0}, {0, 0, 0, 0, 0, 0, 0, 0}
  , {0, 0, 0, 0, 0, 0, 0, 0}}
  , {{0, 0, 0, 0, 0, 0, 0, 0}, {0, 0, 0, 0, 0, 0, 0, 0}, {1, 1, 1, 1, 1, 1, 1, 0}, {1, 1, 0, 0, 0, 0, 1, 1}
  , {1, 1, 0, 0, 0, 0, 1, 1}, {1, 1, 0, 0, 0, 0, 1, 1}, {1, 1, 0, 0, 0, 0, 1, 1}, {1, 1, 1, 1, 1, 1, 1, 0}
  , {1, 1, 0, 0, 0, 0, 0, 0}, {1, 1, 0, 0, 0, 0, 0, 0}, {1, 1, 0, 0, 0, 0, 0, 0}, {1, 1, 0, 0, 0, 0, 0, 0}
  , {1, 1, 0, 0, 0, 0, 0, 0}}
  , {{0, 0, 0, 0, 0, 0, 0, 0}, {0, 0, 0, 0, 0, 0, 0, 0}, {1, 1, 1, 1, 1, 1, 1, 0}, {0, 0, 0, 0, 0, 0, 1, 1}
  , {0, 0, 0, 0, 0, 0, 1, 1}, {0, 1, 1, 1, 1, 1, 1, 1}, {1, 1, 0, 0, 0, 0, 1, 1}, {1, 1, 0, 0, 0, 0, 1, 1}
  , {0, 1, 1, 1, 1, 1, 1, 0}, {0, 0, 0, 0, 0, 0, 0, 0}, {0, 0, 0, 0, 0, 0, 0, 0}, {0, 0, 0, 0, 0, 0, 0, 0}
  , {0, 0, 0, 0, 0, 0, 0, 0}}
  , {{0, 0, 0, 0, 0, 0, 0, 0}, {0, 0, 0, 0, 0, 0, 0, 0}, {0, 0, 0, 0, 1, 1, 0, 0}, {0, 0, 0, 0, 1, 1, 0, 0}
  , {0, 0, 0, 0, 1, 1, 0, 0}, {0, 0, 0, 0, 1, 1, 0, 0}, {0, 0, 0, 0, 1, 1, 0, 0}, {0, 0, 1, 1, 1, 1, 1, 1}
  , {0, 0, 0, 0, 1, 1, 0, 0}, {0, 0, 0, 0, 1, 1, 0, 0}, {0, 0, 0, 0, 1, 1, 0, 0}, {1, 1, 0, 0, 1, 1, 0, 0}
  , {0, 1, 1, 1, 1, 0, 0, 0}}
  , {{0, 1, 1, 1, 1, 1, 1, 0}, {1, 1, 0, 0, 0, 0, 1, 1}, {1, 1, 0, 0, 0, 0, 0, 0}, {1, 1, 0, 0, 0, 0, 0, 0}
  , {1, 1, 1, 1, 1, 1, 1, 0}, {1, 1, 0, 0, 0, 0, 1, 1}, {1, 1, 0, 0, 0, 0, 1, 1}, {1, 1, 0, 0, 0, 0, 1, 1}
  , {0, 1, 1, 1, 1, 1, 1, 0}, {0, 0, 0, 0, 0, 0, 0, 0}, {0, 0, 0, 0, 0, 0, 0, 0}, {0, 0, 0, 0, 0, 0, 0, 0}
  , {0, 0, 0, 0, 0, 0, 0, 0}}
  , {{0, 0, 0, 0, 0, 0, 0, 0}, {0, 0, 0, 0, 0, 0, 0, 0}, {1, 1, 0, 0, 0, 0, 1, 1}, {1, 1, 0, 0, 0, 0, 1, 1}
  , {1, 1, 0, 0, 0, 0, 1, 1}, {1, 1, 0, 0, 0, 0, 1, 1}, {1, 1, 0, 0, 0, 0, 1, 1}, {1, 1, 0, 0, 0, 0, 1, 1}
  , {0, 1, 1, 1, 1, 1, 1, 1}, {0, 0, 0, 0, 0, 0, 1, 1}, {0, 0, 0, 0, 0, 0, 1, 1}, {0, 0, 0, 0, 0, 0, 1, 1}
  , {0, 0, 0, 0, 0, 0, 1, 1}}
  , {{0, 0, 0, 0, 0, 0, 0, 0}, {0, 0, 0, 0, 0, 0, 0, 0}, {0, 0, 0, 1, 1, 0, 0, 0}, {0, 0, 0, 1, 1, 0, 0, 0}
  , {0, 0, 0, 1, 1, 0, 0, 0}, {0, 0, 0, 1, 1, 0, 0, 0}, {0, 0, 0, 1, 1, 0, 0, 0}, {0, 0, 0, 1, 1, 0, 0, 0}
  , {0, 0, 0, 1, 1, 0, 0, 0}, {0, 0, 0, 0, 0, 0, 0, 0}, {0, 0, 0, 0, 0, 0, 0, 0}, {0, 0, 0, 1, 1, 0, 0, 0}
  , {0, 0, 0, 0, 0, 0, 0, 0}}
  , {{0, 0, 0, 1, 1, 1, 0, 0}, {0, 0, 1, 1, 0, 1, 1, 0}, {0, 0, 1, 1, 0, 0, 0, 0}, {0, 0, 1, 1, 0, 0, 0, 0}
  , {0, 0, 1, 1, 0, 0, 0, 0}, {0, 0, 1, 1, 0, 0, 0, 0}, {0, 0, 1, 1, 0, 0, 0, 0}, {0, 0, 1, 1, 0, 0, 0, 0}
  , {0, 0, 1, 1, 0, 0, 0, 0}, {0, 0, 0, 0, 0, 0, 0, 0}, {0, 0, 0, 0, 0, 0, 0, 0}, {0, 0, 1, 1, 0, 0, 0, 0}
  , {0, 0, 0, 0, 0, 0, 0, 0}}
  , {{0, 0, 0, 0, 0, 0, 0, 0}, {0, 0, 0, 0, 0, 0, 0, 0}, {0, 1, 1, 0, 0, 0, 1, 1}, {0, 0, 1, 1, 0, 0, 1, 1}
  , {0, 0, 0, 1, 1, 1, 1, 1}, {0, 0, 0, 0, 1, 1, 1, 1}, {0, 0, 0, 1, 1, 0, 1, 1}, {0, 0, 1, 1, 0, 0, 1, 1}
  , {0, 1, 1, 0, 0, 0, 1, 1}, {0, 0, 0, 0, 0, 0, 1, 1}, {0, 0, 0, 0, 0, 0, 1, 1}, {0, 0, 0, 0, 0, 0, 1, 1}
  , {0, 0, 0, 0, 0, 0, 1, 1}}
  , {{0, 0, 0, 0, 0, 0, 0, 0}, {0, 0, 0, 0, 0, 0, 0, 0}, {0, 1, 1, 1, 1, 1, 1, 0}, {0, 0, 0, 1, 1, 0, 0, 0}
  , {0, 0, 0, 1, 1, 0, 0, 0}, {0, 0, 0, 1, 1, 0, 0, 0}, {0, 0, 0, 1, 1, 0, 0, 0}, {0, 0, 0, 1, 1, 0, 0, 0}
  , {0, 0, 0, 1, 1, 0, 0, 0}, {0, 0, 0, 1, 1, 0, 0, 0}, {0, 0, 0, 1, 1, 0, 0, 0}, {0, 0, 0, 1, 1, 0, 0, 0}
  , {0, 0, 0, 1, 1, 1, 1, 0}}
  , {{0, 0, 0, 0, 0, 0, 0, 0}, {0, 0, 0, 0, 0, 0, 0, 0}, {1, 1, 0, 1, 1, 0, 1, 1}, {1, 1, 0, 1, 1, 0, 1, 1}
  , {1, 1, 0, 1, 1, 0, 1, 1}, {1, 1, 0, 1, 1, 0, 1, 1}, {1, 1, 0, 1, 1, 0, 1, 1}, {1, 1, 0, 1, 1, 0, 1, 1}
  , {0, 1, 1, 1, 1, 1, 1, 1}, {0, 0, 0, 0, 0, 0, 0, 0}, {0, 0, 0, 0, 0, 0, 0, 0}, {0, 0, 0, 0, 0, 0, 0, 0}
  , {0, 0, 0, 0, 0, 0, 0, 0}}
  , {{0, 0, 0, 0, 0, 0, 0, 0}, {0, 0, 0, 0, 0, 0, 0, 0}, {0, 1, 1, 0, 0, 0, 1, 1}, {0, 1, 1, 0, 0, 0, 1, 1}
  , {0, 1, 1, 0, 0, 0, 1, 1}, {0, 1, 1, 0, 0, 0, 1, 1}, {0, 1, 1, 0, 0, 0, 1, 1}, {0, 1, 1, 0, 0, 0, 1, 1}
  , {0, 0, 1, 1, 1, 1, 1, 1}, {0, 0, 0, 0, 0, 0, 0, 0}, {0, 0, 0, 0, 0, 0, 0, 0}, {0, 0, 0, 0, 0, 0, 0, 0}
  , {0, 0, 0, 0, 0, 0, 0, 0}}
  , {{0, 0, 0, 0, 0, 0, 0, 0}, {0, 0, 0, 0, 0, 0, 0, 0}, {0, 0, 1, 1, 1, 1, 1, 0}, {0, 1, 1, 0, 0, 0, 1, 1}
  , {0, 1, 1, 0, 0, 0, 1, 1}, {0, 1, 1, 0, 0, 0, 1, 1}, {0, 1, 1, 0, 0, 0, 1, 1}, {0, 1, 1, 0, 0, 0, 1, 1}
  , {0, 0, 1, 1, 1, 1, 1, 0}, {0, 0, 0, 0, 0, 0, 0, 0}, {0, 0, 0, 0, 0, 0, 0, 0}, {0, 0, 0, 0, 0, 0, 0, 0}
  , {0, 0, 0, 0, 0, 0, 0, 0}}
  , {{0, 0, 0, 0, 0, 0, 1, 1}, {0, 0, 0, 0, 0, 0, 1, 1}, {0, 0, 0, 0, 0, 0, 1, 1}, {0, 1, 1, 1, 1, 1, 1, 1}
  , {1, 1, 0, 0, 0, 0, 1, 1}, {1, 1, 0, 0, 0, 0, 1, 1}, {1, 1, 0, 0, 0, 0, 1, 1}, {1, 1, 0, 0, 0, 0, 1, 1}
  , {0, 1, 1, 1, 1, 1, 1, 1}, {0, 0, 0, 0, 0, 0, 0, 0}, {0, 0, 0, 0, 0, 0, 0, 0}, {0, 0, 0, 0, 0, 0, 0, 0}
  , {0, 0, 0, 0, 0, 0, 0, 0}}
  , {{1, 1, 0, 0, 0, 0, 0, 0}, {1, 1, 0, 0, 0, 0, 0, 0}, {1, 1, 0, 0, 0, 0, 0, 0}, {1, 1, 1, 1, 1, 1, 1, 0}
  , {1, 1, 0, 0, 0, 0, 1, 1}, {1, 1, 0, 0, 0, 0, 1, 1}, {1, 1, 0, 0, 0, 0, 1, 1}, {1, 1, 0, 0, 0, 0, 1, 1}
  , {1, 1, 1, 1, 1, 1, 1, 0}, {0, 0, 0, 0, 0, 0, 0, 0}, {0, 0, 0, 0, 0, 0, 0, 0}, {0, 0, 0, 0, 0, 0, 0, 0}
  , {0, 0, 0, 0, 0, 0, 0, 0}}
  , {{0, 0, 0, 0, 0, 0, 0, 0}, {0, 0, 0, 0, 0, 0, 0, 0}, {0, 0, 0, 0, 0, 0, 1, 1}, {0, 0, 0, 0, 0, 0, 1, 1}
  , {0, 0, 0, 0, 0, 0, 1, 1}, {0, 0, 0, 0, 0, 0, 1, 1}, {0, 0, 0, 0, 0, 0, 1, 1}, {0, 0, 0, 0, 0, 1, 1, 1}
  , {0, 1, 1, 1, 1, 1, 1, 1}, {0, 0, 0, 0, 0, 0, 0, 0}, {0, 0, 0, 0, 0, 0, 0, 0}, {0, 0, 0, 0, 0, 0, 0, 0}
  , {0, 0, 0, 0, 0, 0, 0, 0}}
  , {{0, 0, 0, 0, 0, 0, 0, 0}, {0, 0, 0, 0, 0, 0, 0, 0}, {0, 1, 1, 1, 1, 1, 1, 1}, {1, 1, 0, 0, 0, 0, 0, 0}
  , {1, 1, 0, 0, 0, 0, 0, 0}, {0, 1, 1, 1, 1, 1, 1, 0}, {0, 0, 0, 0, 0, 0, 1, 1}, {0, 0, 0, 0, 0, 0, 1, 1}
  , {1, 1, 1, 1, 1, 1, 1, 0}, {0, 0, 0, 0, 0, 0, 0, 0}, {0, 0, 0, 0, 0, 0, 0, 0}, {0, 0, 0, 0, 0, 0, 0, 0}
  , {0, 0, 0, 0, 0, 0, 0, 0}}
  , {{0, 0, 0, 0, 0, 0, 0, 0}, {0, 0, 0, 0, 0, 0, 0, 0}, {0, 0, 1, 1, 1, 0, 0, 0}, {0, 1, 1, 0, 1, 1, 0, 0}
  , {0, 0, 0, 0, 1, 1, 0, 0}, {0, 0, 0, 0, 1, 1, 0, 0}, {0, 0, 0, 0, 1, 1, 0, 0}, {0, 0, 0, 0, 1, 1, 0, 0}
  , {0, 0, 1, 1, 1, 1, 1, 1}, {0, 0, 0, 0, 1, 1, 0, 0}, {0, 0, 0, 0, 1, 1, 0, 0}, {0, 0, 0, 0, 1, 1, 0, 0}
  , {0, 0, 0, 0, 0, 0, 0, 0}}
  , {{0, 0, 0, 0, 0, 0, 0, 0}, {0, 0, 0, 0, 0, 0, 0, 0}, {0, 1, 1, 1, 1, 1, 1, 0}, {0, 1, 1, 0, 0, 0, 1, 1}
  , {0, 1, 1, 0, 0, 0, 1, 1}, {0, 1, 1, 0, 0, 0, 1, 1}, {0, 1, 1, 0, 0, 0, 1, 1}, {0, 1, 1, 0, 0, 0, 1, 1}
  , {0, 1, 1, 0, 0, 0, 1, 1}, {0, 0, 0, 0, 0, 0, 0, 0}, {0, 0, 0, 0, 0, 0, 0, 0}, {0, 0, 0, 0, 0, 0, 0, 0}
  , {0, 0, 0, 0, 0, 0, 0, 0}}
  , {{0, 0, 0, 0, 0, 0, 0, 0}, {0, 0, 0, 0, 0, 0, 0, 0}, {0, 0, 0, 1, 1, 0, 0, 0}, {0, 0, 1, 1, 1, 1, 0, 0}
  , {0, 0, 1, 1, 1, 1, 0, 0}, {0, 1, 1, 0, 0, 1, 1, 0}, {0, 1, 1, 0, 0, 1, 1, 0}, {1, 1, 0, 0, 0, 0, 1, 1}
  , {1, 1, 0, 0, 0, 0, 1, 1}, {0, 0, 0, 0, 0, 0, 0, 0}, {0, 0, 0, 0, 0, 0, 0, 0}, {0, 0, 0, 0, 0, 0, 0, 0}
  , {0, 0, 0, 0, 0, 0, 0, 0}}
  , {{0, 0, 0, 0, 0, 0, 0, 0}, {0, 0, 0, 0, 0, 0, 0, 0}, {1, 1, 0, 0, 0, 0, 1, 1}, {1, 1, 1, 0, 0, 1, 1, 1}
  , {1, 1, 1, 1, 1, 1, 1, 1}, {1, 1, 0, 1, 1, 0, 1, 1}, {1, 1, 0, 0, 0, 0, 1, 1}, {1, 1, 0, 0, 0, 0, 1, 1}
  , {1, 1, 0, 0, 0, 0, 1, 1}, {0, 0, 0, 0, 0, 0, 0, 0}, {0, 0, 0, 0, 0, 0, 0, 0}, {0, 0, 0, 0, 0, 0, 0, 0}
  , {0, 0, 0, 0, 0, 0, 0, 0}}
  , {{0, 0, 0, 0, 0, 0, 0, 0}, {0, 0, 0, 0, 0, 0, 0, 0}, {1, 1, 0, 0, 0, 0, 1, 1}, {0, 1, 1, 0, 0, 1, 1, 0}
  , {0, 0, 1, 1, 1, 1, 0, 0}, {0, 0, 0, 1, 1, 0, 0, 0}, {0, 0, 1, 1, 1, 1, 0, 0}, {0, 1, 1, 0, 0, 1, 1, 0}
  , {1, 1, 0, 0, 0, 0, 1, 1}, {0, 0, 0, 0, 0, 0, 0, 0}, {0, 0, 0, 0, 0, 0, 0, 0}, {0, 0, 0, 0, 0, 0, 0, 0}
  , {0, 0, 0, 0, 0, 0, 0, 0}}
  , {{0, 0, 0, 0, 0, 0, 1, 1}, {0, 0, 0, 0, 0, 1, 1, 0}, {0, 0, 0, 0, 0, 1, 1, 0}, {0, 0, 0, 0, 1, 1, 0, 0}
  , {0, 0, 0, 1, 1, 0, 0, 0}, {0, 0, 1, 1, 1, 1, 0, 0}, {0, 1, 1, 0, 0, 1, 1, 0}, {0, 1, 1, 0, 0, 1, 1, 0}
  , {1, 1, 0, 0, 0, 0, 1, 1}, {0, 0, 0, 0, 0, 0, 0, 0}, {0, 0, 0, 0, 0, 0, 0, 0}, {0, 0, 0, 0, 0, 0, 0, 0}
  , {0, 0, 0, 0, 0, 0, 0, 0}}
  , {{0, 0, 0, 0, 0, 0, 0, 0}, {0, 0, 0, 0, 0, 0, 0, 0}, {1, 1, 1, 1, 1, 1, 1, 1}, {0, 0, 0, 0, 0, 1, 1, 0}
  , {0, 0, 0, 0, 1, 1, 0, 0}, {0, 0, 0, 1, 1, 0, 0, 0}, {0, 0, 1, 1, 0, 0, 0, 0}, {0, 1, 1, 0, 0, 0, 0, 0}
  , {1, 1, 1, 1, 1, 1, 1, 1}, {0, 0, 0, 0, 0, 0, 0, 0}, {0, 0, 0, 0, 0, 0, 0, 0}, {0, 0, 0, 0, 0, 0, 0, 0}
  , {0, 0, 0, 0, 0, 0, 0, 0}}
  , {{0, 0, 0, 0, 0, 0, 0, 0}, {0, 0, 0, 0, 0, 0, 0, 0}, {1, 1, 1, 1, 0, 0, 0, 0}, {0, 0, 0, 1, 1, 0, 0, 0}
  , {0, 0, 0, 1, 1, 0, 0, 0}, {0, 0, 0, 1, 1, 0, 0, 0}, {0, 0, 0, 1, 1, 1, 0, 0}, {0, 0, 0, 0, 1, 1, 1, 1}
  , {0, 0, 0, 1, 1, 1, 0, 0}, {0, 0, 0, 1, 1, 0, 0, 0}, {0, 0, 0, 1, 1, 0, 0, 0}, {0, 0, 0, 1, 1, 0, 0, 0}
  , {1, 1, 1, 1, 0, 0, 0, 0}}
  , {{0, 0, 0, 1, 1, 0, 0, 0}, {0, 0, 0, 1, 1, 0, 0, 0}, {0, 0, 0, 1, 1, 0, 0, 0}, {0, 0, 0, 1, 1, 0, 0, 0}
  , {0, 0, 0, 1, 1, 0, 0, 0}, {0, 0, 0, 1, 1, 0, 0, 0}, {0, 0, 0, 1, 1, 0, 0, 0}, {0, 0, 0, 1, 1, 0, 0, 0}
  , {0, 0, 0, 1, 1, 0, 0, 0}, {0, 0, 0, 1, 1, 0, 0, 0}, {0, 0, 0, 1, 1, 0, 0, 0}, {0, 0, 0, 1, 1, 0, 0, 0}
  , {0, 0, 0, 1, 1, 0, 0, 0}}
  , {{0, 0, 0, 0, 0, 0, 0, 0}, {0, 0, 0, 0, 0, 0, 0, 0}, {0, 0, 0, 0, 1, 1, 1, 1}, {0, 0, 0, 1, 1, 0, 0, 0}
  , {0, 0, 0, 1, 1, 0, 0, 0}, {0, 0, 0, 1, 1, 0, 0, 0}, {0, 0, 1, 1, 1, 0, 0, 0}, {1, 1, 1, 1, 0, 0, 0, 0}
  , {0, 0, 1, 1, 1, 0, 0, 0}, {0, 0, 0, 1, 1, 0, 0, 0}, {0, 0, 0, 1, 1, 0, 0, 0}, {0, 0, 0, 1, 1, 0, 0, 0}
  , {0, 0, 0, 0, 1, 1, 1, 1}}};


static void __draw_ascii(Plot * self, double topx, double topy, char c, RGBA * color) {
	uint8_t char_index = c - 32 ;
    
  	for(size_t x = 0; x < CHAR_WIDTH; x++) {
    	for(size_t y = 0; y <  CHAR_HEIGHT; y++) {
      		char pixel = ascii_pixel_array[char_index][y][x];

      		if(pixel == 1) 
        		__set_pixel(self, (topx - x) + CHAR_WIDTH,  topy + y, color);
    	}
  	}
}


static void __draw_text(Plot * self, double x, double y, char *text, RGBA * color){
	for(size_t i = 0; text[i] != 0; i++)
  		__draw_ascii(self, x + (i * (CHAR_WIDTH + SPACE_WIDTH)), y, text[i], color);
}


static void __draw_rotate_ascii(Plot * self, double topx, double topy, char c, RGBA * color) {
	uint8_t char_index = c - 32;
    
  	for(size_t y = 0; y < CHAR_HEIGHT; y ++) {
    	for(size_t x = 0; x <  CHAR_WIDTH; x++) {
      		char pixel = ascii_pixel_array[char_index][y][x];

      		if(pixel == 1) {
        		__set_pixel(self, CHAR_HEIGHT + topx - y,  topy +(CHAR_WIDTH - x - 1) ,  color);
            }
    	}
  	}
}


static void __draw_rotate_text(Plot * self, double x, double y, char *text, RGBA * color) {
	for(size_t i = 0; text[i] != 0; i++)
  		__draw_rotate_ascii(self, x, y + ((CHAR_WIDTH + SPACE_WIDTH) * i), text[i], color);
}


static size_t __text_width(char * cstr) {
    return (strlen(cstr) * (CHAR_WIDTH + SPACE_WIDTH)) - SPACE_WIDTH;
}


static double vector_filter(const vector * data, double(*f)(double, double)) {
    vector_reset_iterator(data);

    double result = *(double*) vector_next(data);

    foreach(data, i) {
		result = f(result, *(double*) i);
    }

    return result;
}


typedef struct {
    float left;
    float right;
    float top;
    float bottom;
}Padding;


typedef struct {
    Plot * plot;

    bool show_grid;
    RGBA * grid_color;

    Padding padding;

    float disp_area_width;
    float disp_area_height;   

    float y_offset;

    double scale_x;
    double scale_y;

	double min_x;
	double min_y;
    double max_x;
    double max_y;
	    
    char * x_label;
    char * y_label;
    char * title;
}DisplayArea;


static double __translate_x(DisplayArea * self, double x) {
	return ((x - self->min_x) * self->scale_x) + self->padding.left + 1;
}


static double __translate_y(DisplayArea * self, double y) {
	return ((y - self->min_y) * self->scale_y) + self->padding.bottom + 1; 
}


double __get_interval(double min, double max) {
    double length = max - min;

    double p = floor(log10(length));
	double interval = pow(10, p);

    return interval;
}


double __get_min_chart_position(double min, double interval) {
    return ceil(min/interval)*interval;
}


double __get_max_chart_position(double max, double interval) {
    return floor(max/interval)*interval;
}


size_t __get_n_positions(double chart_min, double chart_max, double interval) {
    return round((chart_max - chart_min)/interval + 1.0);
}




static double grid_step(size_t grid_lines, double min, double max) {
    double rough_step = (max - min) / (grid_lines - 1);
	double exponent = floor(log10(rough_step));  // Zjisti řád kroku
	double base = pow(10, exponent);             // Základ (např. 10^x)
	double normalized_step = rough_step / base;  // Normalizace kroku na interval (1, 10)

	// Násobky 1, 2, 5, nebo 10
	if(normalized_step < 1) {
		normalized_step = 0.5;
	} else if (normalized_step < 1.5) {
		normalized_step = 1;
	} else if (normalized_step < 3) {
		normalized_step = 2;
	} else if (normalized_step < 7) {
		normalized_step = 5;
	} else {
		normalized_step = 10;
	}

    return normalized_step * base;
}


static void draw_grid(DisplayArea * self, bool show_grid, RGBA * color) {
    const size_t grid_lines = 10;

    double step_y = grid_step(grid_lines, self->min_y, self->max_y);
    double step_x = grid_step(grid_lines, self->min_x, self->max_x);

    char buffer[16];

    for(size_t i = 0, size = ceil((self->max_x - self->min_x)/ step_x); i < size; i ++) {

        double pos = self->min_x + (i * step_x);
        double offset_x = round(__translate_x(self, pos)); 
		
        snprintf(buffer, 15, "%.1f", pos);
        if(show_grid == true) {
            if(offset_x != self->padding.left+1 && offset_x != self->plot->width - (self->padding.right - 1)) {
                if(pos == 0)
                    __draw_vertical_line(self->plot, offset_x, self->padding.bottom + 1, self->disp_area_height-1, 1, &RGBA_Black);
                else
                    __draw_vertical_line(self->plot, offset_x, self->padding.bottom + 1, self->disp_area_height-1, 1, color);
            }
        }

        __draw_text(self->plot, offset_x - __text_width(buffer) / 2, self->padding.bottom - 25, buffer, color);
    }    

    for(size_t i = 0, size = ceil((self->max_y - self->min_y)/ step_y); i < size; i ++) {
        double pos = self->min_y + (i * step_y);
        double offset_y = round(__translate_y(self, pos)); 

        snprintf(buffer, 15, "%.2f", pos);

        if(show_grid == true) {
            if(offset_y != self->padding.bottom + 1 && offset_y != self->plot->height - (self->padding.top - 1)) {
                if(pos == 0)
                    __draw_horizontal_line(self->plot, self->padding.left+1, offset_y, self->disp_area_width -1, 1, &RGBA_Black);
                else
                    __draw_horizontal_line(self->plot, self->padding.left+1, offset_y, self->disp_area_width -1, 1, color);
            }
        }

        __draw_text(self->plot, self->padding.left - __text_width(buffer) - 15, offset_y - (CHAR_HEIGHT / 2), buffer, color);
    } 
}


static void draw_display_area(DisplayArea * self) {
    __draw_rectangle(self->plot, self->padding.left, self->padding.bottom, self->disp_area_width, self->disp_area_height, 1, &RGBA_Black);

	/*
	 * draw title
     */
    __draw_text(self->plot, (self->plot->width - __text_width(self->title)) / 2, self->plot->height - self->padding.top + 15, self->title, &RGBA_Black);

     /*
	 * draw x axis label
     */
    __draw_text(self->plot, (self->plot->width - __text_width(self->x_label)) / 2, 15, self->x_label, &RGBA_Black);

     /*
	 * draw y axis label
     */
    __draw_rotate_text(self->plot, 15, self->plot->height / 2 - __text_width(self->y_label) / 2, self->y_label, &RGBA_Black);
}


Plot * scatter_plot_draw(const vector * xs, const vector * ys) {
    ScatterPlot_Series serie = {
        .line_type = Plot_LineType_Solid
        , .legenda = "Legenda" 
        , .line_thickness = 1
        , .xs = xs
        , .ys = ys
        , .color = RGBA_Black};

    ScatterPlot_Settings settings = {
        .width = 800
        , .height = 600
        , .x_label = "axis x"
        , .y_label = "axis y"
        , .title = "Plot"
        , .padding_auto = true
        , .show_grid = true
        , .grid_color = RGBA_Gray
        , .serie_size = 1
        , .serie = (ScatterPlot_Series *[]) {&serie}
    };

    return scatter_plot_draw_from_settings(&settings);
}


typedef struct {
    DisplayArea display;
    
    size_t serie_size;
    ScatterPlot_Series ** serie;
}ScatterPlot;


static inline void __draw_scatter_serie(DisplayArea * self, ScatterPlot_Series * serie) {
    vector_reset_iterator(serie->xs);
    vector_reset_iterator(serie->ys);

	double * x0 = vector_next(serie->xs);
	double * y0 = vector_next(serie->ys);

    assert(x0 != NULL);
    assert(y0 != NULL);

    double px0 = __translate_x(self, *x0);
    double py0 =  __translate_y(self, *y0);

    for(double * x1 = vector_next(serie->xs), *y1 = vector_next(serie->ys)
            ; x1 != NULL && y1 != NULL
            ; x1 = vector_next(serie->xs), y1 = vector_next(serie->ys)) {
		double px1 = __translate_x(self, *x1);
		double py1 = __translate_y(self, *y1) + self->y_offset;

        __draw_curve(self->plot, px0, py0, px1, py1, serie->line_thickness, &serie->color);

		px0 = px1;
		py0 = py1;
    }
}


static void draw_scatter_plot(ScatterPlot * self) {
    double legenda_width = 0;
    double legenda_height = self->serie_size * ((CHAR_HEIGHT + SPACE_WIDTH) + CHAR_HEIGHT / 2);

    for(size_t i = 0; i < self->serie_size; i++) {
        legenda_width = fmax(legenda_width, __text_width(self->serie[i]->legenda));
    }

    legenda_width += 40; 

    /*
     * draw background for legenda
     */
    __draw_filled_rectangle(
            self->display.plot
            , self->display.padding.left+1
            , self->display.plot->height - self->display.padding.top-1-legenda_height
            , legenda_width
            , legenda_height
            , &RGBA_White);


    for(size_t i = 0; i < self->serie_size; i++) {
        if(self->serie[i]->legenda != NULL) {
            __draw_horizontal_line(
                self->display.plot
                , self->display.padding.left + 10
                , self->display.plot->height - self->display.padding.top - (CHAR_HEIGHT*2) - i * (CHAR_HEIGHT + SPACE_WIDTH) + CHAR_HEIGHT / 2
                , 15, 3, &self->serie[i]->color);

            __draw_text(
                self->display.plot
                , self->display.padding.left + 40
                , self->display.plot->height - self->display.padding.top - (CHAR_HEIGHT*2) - i * (CHAR_HEIGHT + SPACE_WIDTH)
                , self->serie[i]->legenda
                , &RGBA_Black);
        }

        __draw_scatter_serie(&self->display, self->serie[i]);
    }
}


static inline DisplayArea scater_plot_display_area(ScatterPlot_Settings * settings) {
    DisplayArea display;

    display.plot = __plot_new(settings->width, settings->height, &RGBA_White);
    
    display.show_grid = settings->show_grid;
    display.grid_color = &settings->grid_color;

    if(settings->padding_auto == true) {
        display.padding = (Padding) {100, 70, 70, 70};
    } else {
        display.padding = (Padding) {
            settings->padding_left
            , settings->padding_right
            , settings->padding_top
            , settings->padding_bottom}; 
    }

    display.disp_area_width = settings->width - display.padding.left - display.padding.right;
    display.disp_area_height = settings->height - display.padding.top - display.padding.bottom;

    display.x_label = settings->x_label;
    display.y_label = settings->y_label;
    display.title = settings->title;

	double chart_x_min = vector_filter(settings->serie[0]->xs, fmin);
	double chart_x_max = vector_filter(settings->serie[0]->xs, fmax);
	double chart_y_min = vector_filter(settings->serie[0]->ys, fmin);
	double chart_y_max = vector_filter(settings->serie[0]->ys, fmax);

	for(size_t i = 1; i < settings->serie_size; i++) {
		chart_x_min = fmin(chart_x_min, vector_filter(settings->serie[i]->xs, fmin));
		chart_x_max = fmax(chart_x_max, vector_filter(settings->serie[i]->xs, fmax));
		chart_y_min = fmin(chart_y_min, vector_filter(settings->serie[i]->ys, fmin));
		chart_y_max = fmax(chart_y_max, vector_filter(settings->serie[i]->ys, fmax)); 
	}

    assert(chart_x_min != chart_x_max);
    
    /*
     * constant function scale treatment 
     */
    if(chart_y_min == chart_y_max) {
        double padding = 0.1 * fabs(chart_y_max);
        if (padding == 0){
            padding = 1.0;
        }
        
        chart_y_min = chart_y_max - padding;
        chart_y_max = chart_y_max + padding;
    }

    double chart_width = chart_x_max - chart_x_min;
    double chart_height = chart_y_max == chart_y_min ? chart_y_max : chart_y_max - chart_y_min;


	display.min_x = chart_x_min;
	display.min_y = chart_y_min;
    display.max_x = chart_x_max;
    display.max_y = chart_y_max;

    display.y_offset = 10;

    //printf("%f %f\n", display.min_y, display.max_y);

    display.scale_x = (display.disp_area_width - 2) / chart_width;
    display.scale_y = (display.disp_area_height - 2 - (2 * display.y_offset)) / chart_height;

    return display;
}


Plot * scatter_plot_draw_from_settings(ScatterPlot_Settings * settings) {
    assert(settings->serie_size > 0);

    ScatterPlot scatter_plot = {
        .display = scater_plot_display_area(settings)
        , .serie_size = settings->serie_size
        , .serie = settings->serie
    };

    draw_display_area(&scatter_plot.display);
    draw_grid(&scatter_plot.display, settings->show_grid, &settings->grid_color);
    draw_scatter_plot(&scatter_plot);

    return scatter_plot.display.plot;   
}


void plot_delete(Plot * self) {
    if(self != NULL) {
        free(self);
    }
}


static void range_reset(Range * self) {
    self->iterator = self->start;
}


static double * range_next(Range * self) {
    if(self->iterator < self->end) {
        self->value = self->iterator;
        self->iterator += self->step;
        return &self->value;
    } else {
        return NULL;
    }
}


Range range(double start, double end, double step) {
    return (Range) {
        .vector = {
            .reset_iterator = (void(*)(const vector*)) range_reset
            , .next = (void*(*)(const vector*)) range_next
        }
        , .start = start
        , .end = end
        , .step = step
        , .iterator = start
    };
}



